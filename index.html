<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>PPN ê³„ì‚°ê¸° (Cats)</title>
  <meta name="description" content="ê³ ì–‘ì´ ì „ìš© PPN ê³„ì‚°ê¸° Â· 5DW / AA8.5% / Lipid20%" />
  <style>
    :root{
      --blue:#1d4ed8; --red:#dc2626; --muted:#64748b; --bg:#f8fafc; --card:#fff; --border:#e5e7eb;
    }
    body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;margin:0;background:var(--bg);color:#0f172a;padding:12px}
    h2{margin:0 0 12px;font-size:1.35rem;color:var(--blue);text-align:center}
    h3{margin:0 0 8px;font-size:1.05rem;color:var(--blue)}
    .red-title{color:var(--red)}
    .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px;margin-bottom:12px;box-shadow:0 2px 6px rgba(0,0,0,.04)}
    .row{display:flex;flex-direction:row;gap:12px;flex-wrap:wrap}
    .input-box{border:2px solid var(--blue);border-radius:10px;padding:10px;background:#f9fafb;box-sizing:border-box}
    .input-box.label-small{flex:0.6;min-width:100px}
    .input-box.label-large{flex:1.4;min-width:180px}
    .input-box label{display:block;font-size:.92rem;margin-bottom:4px;color:var(--blue)}
    .input-box input[type=number], .input-box select{width:100%;padding:10px;font-size:1rem;border:1px solid var(--border);border-radius:8px;background:#fff;box-sizing:border-box}
    .input-box input[type=number]:focus, .input-box select:focus{outline:none;border-color:var(--blue);}
    .tabs{display:flex;gap:8px;margin-bottom:8px}
    .tab{flex:1;padding:6px 8px;text-align:center;border:1px solid var(--border);border-radius:6px;cursor:pointer;font-size:.9rem}
    .tab.active{background:var(--blue);color:#fff}
    .hint{font-size:.8rem;color:var(--muted)}
    table{width:100%;border-collapse:collapse;font-size:.92rem}
    th,td{padding:6px;border-bottom:1px solid var(--border);text-align:left}
    th{color:#0f172a}
    tfoot td{font-weight:600}
    .right{text-align:right}
    .total{background:#eff6ff}
    .flow{font-weight:700;color:var(--blue);text-align:center;margin-top:6px}
    .note{font-size:.8rem;color:#6b7280;margin-top:4px}
    .smallnote{font-size:.75rem;color:#6b7280;margin-left:4px}
    .kcl-line{display:flex;align-items:center;gap:8px;flex-wrap:wrap;border:1px dashed var(--border);border-radius:8px;padding:10px;background:#fff}
    .kcl-line strong{color:#111827}
    .kcl-select{padding:8px 10px;font-size:1rem;min-width:120px;border:1px solid var(--border);border-radius:8px;background:#fff}
  </style>
</head>
<body>
  <h2>ê³ ì–‘ì´ ì¹¼ë¡œë¦¬/PPN ê³„ì‚°ê¸°</h2>

  <div class="card">
    <h3>âš™ï¸ ì…ë ¥</h3>
    <div class="row">
      <div class="input-box label-small">
        <label for="bw">ì²´ì¤‘ (kg)</label>
        <input id="bw" type="number" step="0.1" placeholder="*í•„ìˆ˜" >
      </div>
      <div class="input-box label-large">
        <label for="condition">ìƒíƒœ ì„ íƒ</label>
        <select id="condition">
          <option value="1">ê¸°íƒ€/ì§ˆí™˜ í™˜ì (ê³„ìˆ˜ 1.0)</option>
          <option value="1.3">ì •ìƒ í™œë™ (ê³„ìˆ˜ 1.3)</option>
          <option value="0.9">ì¤‘ì„±í™”/ì €í™œë™ (ê³„ìˆ˜ 0.9)</option>
          <option value="2.2">ì„±ì¥/ìˆ˜ìœ  (ê³„ìˆ˜ 2.2)</option>
          <option value="0.8">ì²´ì¤‘ ê°ëŸ‰ (ê³„ìˆ˜ 0.8, ê¶Œì¥: 52 kcalÂ·kgâ»â°Â·â·Â¹Â¹/ì¼)</option>
        </select>
      </div>
    </div>
  </div>

  <div class="card">
    <h3>ğŸ§® ì—ë„ˆì§€ (2021 AAHA ê¸°ì¤€)</h3>
    <table>
      <thead><tr><th>ì§€í‘œ</th><th class="right">kcal/day</th></tr></thead>
      <tbody>
        <tr><td>RER <span class="smallnote">(70 Ã— BW^0.75)</span></td><td class="right" id="valRER">-</td></tr>
        <tr><td>MER <span class="smallnote">(RER Ã— ìƒíƒœ ê³„ìˆ˜)</span></td><td class="right" id="valIER">-</td></tr>
        <tr><td>PER <span class="smallnote">(0.5 Ã— RER, ì´ˆê¸° íˆ¬ì—¬)</span></td><td class="right" id="valPER">-</td></tr>
      </tbody>
    </table>
    <p class="note">
      â€» <span style="color:#8B0000; font-weight:600;">RER</span> (Resting Energy Requirement) : ìƒëª…ìœ ì§€ ìœ„í•œ ìµœì†Œ ì—ë„ˆì§€í•„ìš”ëŸ‰ <br>
      â€» <span style="color:#8B0000; font-weight:600;">MER</span> (Maintenance Energy Requirement) : í™œë™,ìƒíƒœ ë°˜ì˜í•œ ì—ë„ˆì§€í•„ìš”ëŸ‰ <br>
      â€» <span style="color:#8B0000; font-weight:600;">PER</span> (Parenteral Energy Requirement)ì€ ê°€ì´ë“œë¼ì¸ì— ì§ì ‘ ì–¸ê¸‰ë˜ì§€ ì•Šìœ¼ë©°, ì„ìƒì—ì„œ ê´€í–‰ì ìœ¼ë¡œ RERì˜ ì•½ 50%ë¥¼ ì´ˆê¸° PPN íˆ¬ì—¬ ê¸°ì¤€ìœ¼ë¡œ í™œìš©í•˜ëŠ” ê°’ì…ë‹ˆë‹¤.</p>
  </div>

  <div class="card">
    <h3>ğŸ¶ ì¼ì¼ ì¡°ì„± (ê¸°ì¤€ì§€í‘œ ì„ íƒí•´ì£¼ì„¸ìš”)</h3>
    <div class="tabs">
      <div class="tab active" data-target="PER">PER</div>
      <div class="tab" data-target="MER">MER</div>
      <div class="tab" data-target="RER">RER</div>
    </div>
 
    <table>
      <thead><tr><th>ì„±ë¶„</th><th class="right">ëª©í‘œ kcal</th><th class="right">ml/day</th></tr></thead>
      <tbody>
        <tr><td>Dextrose 5% (0.17 kcal/ml)</td><td class="right" id="kDex">-</td><td class="right" id="mDex">-</td></tr>
        <tr><td>Amino Acid 8.5% (0.34 kcal/ml)</td><td class="right" id="kAA">-</td><td class="right" id="mAA">-</td></tr>
        <tr><td>Lipid 20% (2 kcal/ml)</td><td class="right" id="kLip">-</td><td class="right" id="mLip">-</td></tr>
        <tr><td>Multivitamins</td><td class="right">â€”</td><td class="right">0.5</td></tr>
        <tr><td>Trace elements</td><td class="right">â€”</td><td class="right">0.5</td></tr>
      </tbody>
      <tfoot>
        <tr class="total"><td>í•©ê³„(ì œì œ)</td><td class="right" id="sumKcal">-</td><td class="right" id="sumBase">-</td></tr>
        <tr><td>+ Saline (ì„ íƒ, ml/day)</td><td class="right">â€”</td><td class="right"><input id="saline" type="number" step="1" placeholder="ì˜ˆ: 0" value="0" style="max-width:100px"></td></tr>
        <tr class="total"><td>ì´ ëª©í‘œ ì¹¼ë¡œë¦¬ ë° ë¶€í”¼</td><td class="right" id="sumKcalTotal">-</td><td class="right" id="sumTotal">-</td></tr>
      </tfoot>
    </table>
        <p class="note">â€» ì´ ì¹¼ë¡œë¦¬ë¥¼ Dex/AA/Lipid = 25/25/50 (%) ë¡œ ê³„ì‚°í•¨. </p>
    <div class="flow" id="flow">â€” ml/hr</div>
  </div>

  <div class="card">
    <h3 class="red-title">ğŸ§¾ ì„ìƒ í¸ì˜ ì¡°ì œë²•</h3>
    <p class="hint">1) ë² ì´ìŠ¤ìˆ˜ì•¡(100 mL)ì— Amino Acid + Lipid ë¥¼ ì¶”ê°€í•˜ì—¬ ì¡°ì œí•©ë‹ˆë‹¤.<br>2) ì•„ë˜ëŠ” í•œ íŒ©ë‹¹ ì™„ì„±ë¶€í”¼ ë° í•˜ë£¨ í•„ìš” íŒ© ìˆ˜ ê³„ì‚°ì…ë‹ˆë‹¤.<br>3) ì´í›„ ìµœì¢… íŒ© ë¶€í”¼ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì›í•˜ëŠ” KCl ë³´ì • ëª©í‘œë¥¼ ì •í•˜ê³ , ê³„ì‚°ëœ KCl-40 ìš©ëŸ‰ìœ¼ë¡œ ì¡°ì œí•˜ì„¸ìš”.</p>
    <table>
      <thead><tr><th>ì„±ë¶„</th><th class="right">íŒ© ë‹¹ ì²¨ê°€ëŸ‰ (mL)</th></tr></thead>
      <tbody>
        <tr><td>Dextrose 5% (ë² ì´ìŠ¤)</td><td class="right">100</td></tr>
        <tr><td>Amino Acid 8.5%</td><td class="right" id="packAA">-</td></tr>
        <tr><td>Lipid 20%</td><td class="right" id="packLip">-</td></tr>
      </tbody>
      <tfoot>
        <tr class="total"><td>1íŒ©ë‹¹ ìµœì¢… ë¶€í”¼ ë° ì¹¼ë¡œë¦¬</td><td class="right" id="packVol">-</td></tr>
        <tr class="total"><td>ì—ë„ˆì§€ëŸ‰ì— ë”°ë¥¸ ì´ í™˜ë¬˜ì˜ 1ì¼ í•„ìš” ê°œìˆ˜ (ë‹¨ìœ„:íŒ©)</td><td class="right" id="packCount">-</td></tr>
      </tfoot>
    </table>

    <h3 class="red-title" style="margin-top:16px">âš¡ KCl ë³´ì •</h3>
    <p class="hint">ëª©í‘œ ë³´ì •ì¹˜ (mEq/L ê¸°ì¤€) ë¥¼ ì„ íƒí•˜ë©´, ì¡°ì œëœ í•œ íŒ©ì˜ ìµœì¢… ë¶€í”¼ì— ë§ì¶° í•„ìš”í•œ KCl ìš©ëŸ‰ì´ ê³„ì‚°ë©ë‹ˆë‹¤. (K-40 ê¸°ì¤€)</p>

    <div class="kcl-line">
      <strong>KCl ë³´ì • ëª©í‘œ</strong>
      <select id="kclTarget" class="kcl-select">
        <option value="10">10</option>
        <option value="20">20</option>
        <option value="40">40</option>
        <option value="80" selected>80</option>
        <option value="100">100</option>
      </select>
      <span>mEq â€” ì¡°ì œí•˜ì—¬ ì™„ì„±ëœ 1íŒ©ë‹¹</span>
      <strong id="packKCl">-</strong>
      <span>mL</span>
    </div>
  </div>

<script>
  const KCAL_PER_ML = { dex: 0.17, aa: 0.34, lip: 2.00 };
  const V_MVI = 0.5, V_TRACE = 0.5;
  const PACK_VOL = 100;
  const KCL_CONC = 2; 

  const $ = (id)=>document.getElementById(id);
  const bw = $('bw');
  const condition = $('condition');
  const saline = $('saline');

  const valRER = $('valRER');
  const valIER = $('valIER');
  const valPER = $('valPER');
  const kDex = $('kDex'), kAA = $('kAA'), kLip = $('kLip');
  const mDex = $('mDex'), mAA = $('mAA'), mLip = $('mLip');
  const sumBase = $('sumBase'), sumTotal = $('sumTotal');
  const sumKcal = $('sumKcal'), sumKcalTotal = $('sumKcalTotal');
  const flow = $('flow');

  const packAA = $('packAA'), packLip = $('packLip');
  const packKCl=$('packKCl');
  const packCount=$('packCount');
  const packVol=$('packVol');
  const kclTarget=$('kclTarget');

  function fmt(x, d=0){ if(isNaN(x)) return '-'; return Number(x).toFixed(d); }

  let currentTarget = 'PER';

  function recalc(){
    const BW = parseFloat(bw.value);
    const factor = parseFloat(condition.value);
    const addSaline = parseFloat(saline.value||'0')||0;
    if(isNaN(BW) || BW<=0) return;

    const RER = 70 * Math.pow(BW,0.75);
    const MER = RER * factor;
    const PER = 0.5 * RER;

    valRER.textContent = fmt(RER,0);
    valIER.textContent = fmt(MER,0);
    valPER.textContent = fmt(PER,0);

    let targetKcal = PER;
    if(currentTarget==='MER') targetKcal = MER;
    else if(currentTarget==='RER') targetKcal = RER;

    const kcalDex = 0.25*targetKcal;
    const kcalAA  = 0.25*targetKcal;
    const kcalLip = 0.50*targetKcal;

    kDex.textContent = fmt(kcalDex,0);
    kAA.textContent  = fmt(kcalAA,0);
    kLip.textContent = fmt(kcalLip,0);

    const vDex = kcalDex / KCAL_PER_ML.dex;
    const vAA  = kcalAA  / KCAL_PER_ML.aa;
    const vLip = kcalLip / KCAL_PER_ML.lip;

    mDex.textContent = fmt(vDex,0);
    mAA.textContent  = fmt(vAA,0);
    mLip.textContent = fmt(vLip,0);

    const baseSum = vDex + vAA + vLip + V_MVI + V_TRACE;
    sumBase.textContent = fmt(baseSum,0);
    sumKcal.textContent = fmt(targetKcal,0);

    const total = baseSum + addSaline;
    sumTotal.textContent = fmt(total,0);
    sumKcalTotal.textContent = fmt(targetKcal,0);

    flow.textContent = `${fmt(total/24,1)} mL/hr`;

    // ==== ì„ìƒ ì¡°ì œ: ë¹„ìœ¨ ê³ ì • (Dex/AA/Lip = 25/25/50) ====
    const Kpack = (PACK_VOL * KCAL_PER_ML.dex) / 0.25; // 68 kcal/pack
    const aaPerPack  = (0.25 * Kpack) / KCAL_PER_ML.aa; // 50 mL/pack
    const lipPerPack = (0.50 * Kpack) / KCAL_PER_ML.lip; // 17 mL/pack
    const Vpack = PACK_VOL + aaPerPack + lipPerPack;     // 167 mL/pack

    const N = Math.max(1, targetKcal / Kpack);

    packAA.textContent  = fmt(aaPerPack,1);
    packLip.textContent = fmt(lipPerPack,1);
    packVol.textContent = `${fmt(Vpack,1)} mL / ${fmt(Kpack,0)} kcal`;
    packCount.textContent = fmt(N,1);

    const T = parseFloat(kclTarget.value);
    const C = KCL_CONC;
    // 1000mL ê¸°ì¤€ìœ¼ë¡œ ê³„ì‚° ë³€ê²½
    const kclPerPack = (T/1000) * Vpack / C;
    packKCl.textContent = fmt(kclPerPack,1);
  }

  const tabs = document.querySelectorAll('.tab');
  tabs.forEach(tab=>{
    tab.addEventListener('click',()=>{
      tabs.forEach(t=>t.classList.remove('active'));
      tab.classList.add('active');
      currentTarget = tab.dataset.target;
      recalc();
    });
  });

  [bw, condition, saline, kclTarget].forEach(el=>{ ['input','change','keyup'].forEach(evt=> el.addEventListener(evt, recalc)); });
  recalc();
</script>

</body>
</html>
